# Bark Implementation Walkthrough

## What Was Built

Bark is a modular chatbot for ScottyLabs with:

1. **OpenRouter Core** - Chat completions with full tool calling support
2. **Slack Integration** - Events API with thread-aware conversations
3. **CLI** - Interactive mode for testing
4. **Railway Deployment** - Docker + Railway config ready to deploy

## Architecture

```mermaid
graph TB
    CLI[CLI Interface] --> CB[ChatBot]
    SLACK[Slack Events API] --> CB
    CB --> OR[OpenRouter Client]
    CB --> TR[Tool Registry]
    OR --> API[OpenRouter API]
```

## Key Files

| File | Purpose |
|------|---------|
| [chatbot.py](file:///Users/tsumacpro/ScottyLabs/bark/src/bark/core/chatbot.py) | Main [ChatBot](file:///Users/tsumacpro/ScottyLabs/bark/src/bark/core/chatbot.py#35-121) class with conversation management |
| [openrouter.py](file:///Users/tsumacpro/ScottyLabs/bark/src/bark/core/openrouter.py) | Async OpenRouter client with tool call loop |
| [tools.py](file:///Users/tsumacpro/ScottyLabs/bark/src/bark/core/tools.py) | Tool system with `@tool` decorator |
| [handler.py](file:///Users/tsumacpro/ScottyLabs/bark/src/bark/integrations/slack/handler.py) | Slack event handler with thread support |
| [server.py](file:///Users/tsumacpro/ScottyLabs/bark/src/bark/server.py) | FastAPI server for Slack Events API |

## Verification Results

```
✓ Core imports OK
✓ Slack imports OK  
✓ Server imports OK

✓ All imports successful!
```

## Next Steps

1. **Set up environment variables:**
   ```bash
   cp .env.example .env
   # Edit .env with your OpenRouter API key
   ```

2. **Test locally with CLI:**
   ```bash
   uv run bark
   ```

3. **Create Slack app** (see [README](file:///Users/tsumacpro/ScottyLabs/bark/README.md) for detailed steps)

4. **Deploy to Railway:**
   ```bash
   railway login
   railway init
   railway variables set OPENROUTER_API_KEY=...
   railway up
   ```

## Adding Tools

Use the `@tool` decorator to add capabilities:

```python
from bark.core.tools import tool

@tool(
    name="search_scottylabs",
    description="Search for information about ScottyLabs projects",
    parameters={
        "type": "object",
        "properties": {
            "query": {"type": "string", "description": "Search query"}
        },
        "required": ["query"]
    }
)
async def search_scottylabs(query: str) -> str:
    # Implementation here
    return f"Results for: {query}"
```

Then import the module in [server.py](file:///Users/tsumacpro/ScottyLabs/bark/src/bark/server.py) to register it.
